# ============================================
# TG Challenge Bot - Cloudflare Workers Config
# ============================================
#
# SETUP INSTRUCTIONS:
# 1. Run: npx wrangler login
# 2. Run: npx wrangler kv namespace create CHALLENGE_KV
# 3. Copy the ID from output and paste below
# 4. Run: npx wrangler secret put BOT_TOKEN
# 5. Run: npx wrangler secret put GEMINI_API_KEY
# 6. Run: npx wrangler deploy
#

name = "tg-challenge-bot"
main = "worker.js"
compatibility_date = "2024-12-01"

# ============================================
# KV Storage (create with: npx wrangler kv namespace create CHALLENGE_KV)
# ============================================
[[kv_namespaces]]
binding = "CHALLENGE_KV"
id = "YOUR_KV_NAMESPACE_ID_HERE"  # <-- Replace after running setup

# ============================================
# Environment Variables (public config)
# ============================================
[vars]
# Your Telegram Group ID (get from @RawDataBot or @getidsbot)
CHAT_ID = ""

# Topic IDs for your challenges (0 = General topic / no topics)
TOPIC_DAILY = "0"
TOPIC_WEEKLY = "0"
TOPIC_MONTHLY = "0"
TOPIC_WINNERS = "0"

# Timezone offset from UTC (e.g., 3 for Moscow, 0 for London)
TIMEZONE_OFFSET = "3"

# Bot language: "ru" or "en"
BOT_LANGUAGE = "ru"

# ============================================
# Cron Triggers (UTC time!)
# ============================================
# Adjust these based on your timezone
# Default: Moscow time (UTC+3), challenges at 20:00 local = 17:00 UTC
[triggers]
crons = [
  # DAILY: Generate poll at 08:00 local (05:00 UTC), start at 20:00 local (17:00 UTC)
  "0 5 * * *",   # Generate daily poll
  "0 17 * * *",  # Start daily challenge + finish previous

  # WEEKLY: Generate on Saturday, start on Sunday
  "0 10 * * 6",  # Saturday 13:00 local - generate weekly poll
  "0 17 * * 0",  # Sunday 20:00 local - start weekly challenge

  # MONTHLY: Generate on 28th, start on 1st
  "0 10 28 * *", # 28th 13:00 local - generate monthly poll
  "0 17 1 * *"   # 1st 20:00 local - start monthly challenge
]

# ============================================
# Secret Variables (set with: npx wrangler secret put NAME)
# ============================================
# BOT_TOKEN - Your Telegram bot token from @BotFather
# GEMINI_API_KEY - Your Google AI API key from https://aistudio.google.com/apikey
